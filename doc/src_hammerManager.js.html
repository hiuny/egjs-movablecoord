<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Source: src/hammerManager.js | egjs::movableCoord - API</title>
    
    <meta name="description" content="A module used to change the information of user action entered by various input devices such as touch screen or mouse into logical coordinates within the virtual coordinate system. The coordinate information sorted by time events occurred is provided if animations are made by user actions. You can implement a user interface by applying the logical coordinates provided. " />
    
        <meta name="keywords" content="jQuery, UI Component, egjs, movableCoord" />
        <meta name="keyword" content="jQuery, UI Component, egjs, movableCoord" />
    
    
    
    <meta property="og:title" content=""/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content=""/>
    
    <meta property="og:url" content=""/>
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link rel="canonical" href="http://naver.github.io/egjs/latest/doc/"/>
    
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/jaguar.css">
    
    
    <script>
    var config = {"monospaceLinks":true,"cleverLinks":true,"default":{"outputSourceFiles":true},"applicationName":"egjs","disqus":"egjs","googleAnalytics":"","openGraph":{"title":"","type":"website","image":"","site_name":"","url":""},"meta":{"title":"egjs::movableCoord - API","description":"A module used to change the information of user action entered by various input devices such as touch screen or mouse into logical coordinates within the virtual coordinate system. The coordinate information sorted by time events occurred is provided if animations are made by user actions. You can implement a user interface by applying the logical coordinates provided. ","keyword":"jQuery, UI Component, egjs, movableCoord"},"linenums":true,"link":{"canonical":"http://naver.github.io/egjs/latest/doc/"}};
    </script>
    

    
</head>
<body>
<div id="wrap" class="clearfix">
    
<div class="navigation">
    <h3 class="applicationName"><a href="index.html">egjs</a></h3>

    <div class="search">
        <input id="search" type="text" class="form-control input-sm" placeholder="Search Documentations">
    </div>
    <ul class="list">
    
        <!-- Non Grouping Version -->
        
            

        
            

<li class="item" data-name="eg.MovableCoord">
    <span class="title">
        <a href="eg.MovableCoord.html">eg.MovableCoord</a>
        
    </span>
    <ul class="members itemMembers expends">
    
    <span class="subtitle">Members</span>
    
        <li data-name="eg.MovableCoord.DIRECTION_ALL"><a href="eg.MovableCoord.html#.DIRECTION_ALL">DIRECTION_ALL</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_DOWN"><a href="eg.MovableCoord.html#.DIRECTION_DOWN">DIRECTION_DOWN</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_HORIZONTAL"><a href="eg.MovableCoord.html#.DIRECTION_HORIZONTAL">DIRECTION_HORIZONTAL</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_LEFT"><a href="eg.MovableCoord.html#.DIRECTION_LEFT">DIRECTION_LEFT</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_NONE"><a href="eg.MovableCoord.html#.DIRECTION_NONE">DIRECTION_NONE</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_RIGHT"><a href="eg.MovableCoord.html#.DIRECTION_RIGHT">DIRECTION_RIGHT</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_UP"><a href="eg.MovableCoord.html#.DIRECTION_UP">DIRECTION_UP</a></li>
    
        <li data-name="eg.MovableCoord.DIRECTION_VERTICAL"><a href="eg.MovableCoord.html#.DIRECTION_VERTICAL">DIRECTION_VERTICAL</a></li>
    
    </ul>
    <ul class="typedefs itemMembers expends">
    
    </ul>
    <ul class="methods itemMembers expends">
    
    <span class="subtitle">Methods</span>
    
        <li data-name="eg.MovableCoord#bind"><a href="eg.MovableCoord.html#bind">bind</a></li>
    
        <li data-name="eg.MovableCoord#destroy"><a href="eg.MovableCoord.html#destroy">destroy</a></li>
    
        <li data-name="eg.MovableCoord#disableInput"><a href="eg.MovableCoord.html#disableInput">disableInput</a></li>
    
        <li data-name="eg.MovableCoord#enableInput"><a href="eg.MovableCoord.html#enableInput">enableInput</a></li>
    
        <li data-name="eg.MovableCoord#get"><a href="eg.MovableCoord.html#get">get</a></li>
    
        <li data-name="eg.MovableCoord#getHammer"><a href="eg.MovableCoord.html#getHammer">getHammer</a></li>
    
        <li data-name="eg.MovableCoord#hasOn"><a href="eg.MovableCoord.html#hasOn">hasOn</a></li>
    
        <li data-name="eg.MovableCoord#off"><a href="eg.MovableCoord.html#off">off</a></li>
    
        <li data-name="eg.MovableCoord#on"><a href="eg.MovableCoord.html#on">on</a></li>
    
        <li data-name="eg.MovableCoord#once"><a href="eg.MovableCoord.html#once">once</a></li>
    
        <li data-name="eg.MovableCoord#option"><a href="eg.MovableCoord.html#option">option</a></li>
    
        <li data-name="eg.MovableCoord#setBy"><a href="eg.MovableCoord.html#setBy">setBy</a></li>
    
        <li data-name="eg.MovableCoord#setTo"><a href="eg.MovableCoord.html#setTo">setTo</a></li>
    
        <li data-name="eg.MovableCoord#trigger"><a href="eg.MovableCoord.html#trigger">trigger</a></li>
    
        <li data-name="eg.MovableCoord#unbind"><a href="eg.MovableCoord.html#unbind">unbind</a></li>
    
    </ul>
    <ul class="events itemMembers expends">
    
    <span class="subtitle">Events</span>
    
        <li data-name="eg.MovableCoord#event:animationEnd"><a href="eg.MovableCoord.html#event:animationEnd">animationEnd</a></li>
    
        <li data-name="eg.MovableCoord#event:change"><a href="eg.MovableCoord.html#event:change">change</a></li>
    
        <li data-name="eg.MovableCoord#event:hold"><a href="eg.MovableCoord.html#event:hold">hold</a></li>
    
        <li data-name="eg.MovableCoord#event:release"><a href="eg.MovableCoord.html#event:release">release</a></li>
    
    </ul>

    

</li>

        
    
    </ul>
</div>

    <div class="main">
        <h1 class="page-title" data-filename="src_hammerManager.js.html">Source: src/hammerManager.js</h1>
        


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Hammer from "hammerjs";
import {$} from "./utils";
import {DIRECTION, UNIQUEKEY, SUPPORT_TOUCH} from "./consts";

/**
 * Hammer helps you add support for touch gestures to your page
 *
 * @external Hammer
 * @see {@link http://hammerjs.github.io|Hammer.JS}
 * @see {@link http://hammerjs.github.io/jsdoc/Hammer.html|Hammer.JS API documents}
 * @see Hammer.JS applies specific CSS properties by {@link http://hammerjs.github.io/jsdoc/Hammer.defaults.cssProps.html|default} when creating an instance. The eg.MovableCoord module removes all default CSS properties provided by Hammer.JS
 */
if (typeof Hammer === "undefined") {
	throw new Error(`The Hammerjs must be loaded before eg.MovableCoord.\nhttp://hammerjs.github.io/`);
}

export default class HammerManager {
	constructor() {
		this._hammers = {};
	}

	static createHammer(el, bindOptions, inputClass, handler) {
		try {
			// create Hammer
			return HammerManager.attachHammerEvents(new Hammer.Manager(el, {
				recognizers: [
					[
						Hammer.Pan, {
							direction: bindOptions.direction,
							threshold: 0,
						},
					],
				],

				// css properties were removed due to usablility issue
				// http://hammerjs.github.io/jsdoc/Hammer.defaults.cssProps.html
				cssProps: {
					userSelect: "none",
					touchSelect: "none",
					touchCallout: "none",
					userDrag: "none",
				},
				inputClass,
			}), bindOptions, handler);
		} catch (e) {
			return null;
		}
	}

	static attachHammerEvents(hammer, options, handler) {
		const enable = hammer.get("pan").options.enable;

		/* eslint-disable no-underscore-dangle */
		return hammer
			.on("hammer.input", e => {
				if (e.isFirst) {
					// apply options each
					handler._setCurrentTarget(hammer, options);
					enable &amp;&amp; handler._start(e);
				} else if (e.isFinal) {
					// substitute .on("panend tap", this._panend); Because it(tap, panend) cannot catch vertical(horizontal) movement on HORIZONTAL(VERTICAL) mode.
					enable &amp;&amp; handler._end(e);
				}
			}).on("panstart panmove", e => handler._move(e));
		/* eslint-enable no-underscore-dangle */
	}

	static detachHammerEvents(hammer) {
		hammer.off("hammer.input panstart panmove panend");
	}

	static convertInputType(inputType = []) {
		let hasTouch = false;
		let hasMouse = false;
		const inputs = inputType || [];

		inputs.forEach(v => {
			switch (v) {
				case "mouse" : hasMouse = true; break;
				case "touch" : hasTouch = SUPPORT_TOUCH;
				// no default
			}
		});
		return (hasTouch &amp;&amp; Hammer.TouchInput) ||
			(hasMouse &amp;&amp; Hammer.MouseInput) || null;
	}

	add(element, options, handler) {
		const el = $(element);
		let keyValue = el.getAttribute(UNIQUEKEY);
		const bindOptions = Object.assign({
			direction: DIRECTION.DIRECTION_ALL,
			scale: [1, 1],
			thresholdAngle: 45,
			interruptable: true,
			inputType: ["touch", "mouse"],
		}, options);
		const inputClass = HammerManager.convertInputType(bindOptions.inputType);

		if (!inputClass) {
			return;
		}

		if (keyValue) {
			this._hammers[keyValue].hammer.destroy();
		} else {
			keyValue = Math.round(Math.random() * new Date().getTime());
		}
		this._hammers[keyValue] = {
			hammer: HammerManager.createHammer(
				el,
				bindOptions,
				inputClass,
				handler
			),
			el,
			options: bindOptions,
		};
		el.setAttribute(UNIQUEKEY, keyValue);
	}

	remove(element) {
		const el = $(element);
		const key = el.getAttribute(UNIQUEKEY);

		if (key) {
			const hammer = this._hammers[key].hammer;

			HammerManager.detachHammerEvents(hammer);
			hammer.destroy();
			delete this._hammers[key];
			el.removeAttribute(UNIQUEKEY);
		}
	}

	getHammer(element) {
		const data = this.get(element);

		return data ? data.hammer : null;
	}

	get(element) {
		const el = $(element);
		const key = el ? el.getAttribute(UNIQUEKEY) : null;

		if (key &amp;&amp; this._hammers[key]) {
			return this._hammers[key];
		} else {
			return null;
		}
	}

	inputControl(isEnable, element) {
		const option = {
			enable: isEnable,
		};

		if (element) {
			const hammer = this.getHammer(element);

			hammer &amp;&amp; hammer.get("pan").set(option);
		} else { // for multi
			for (const p in this._hammers) {
				this._hammers[p].hammer.get("pan").set(option);
			}
		}
		return this;
	}

	destroy() {
		for (const p in this._hammers) {
			this.remove(this._hammers[p].el);
		}
		this._hammers = {};
	}
}
</code></pre>
        </article>
    </section>






        
        <!-- disqus code -->
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        <!-- // disqus code -->
        

        <footer>
            Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Wed Apr 05 2017 21:45:53 GMT+0900 (KST)
        </footer>
    </div>
</div>
<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
<script src="scripts/main.js"></script>
</body>
</html>
